<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title> AI Chatbot </title>
    <link rel="icon" type="image/icon" href="club-ai.gif" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <div class="scaffold">
        <h1>This is a demo for chatbot of an IT club (CCITC) built using Dialogflow </h1>
        <div id="minion-bot">
          <img src="assets/minion-bot.png" alt="minion bot" />
          <img src="assets/minion-eye.png" class="eye" alt="minion eye"/>
        </div>
        <p>Ask her about CCITC</p>
      </div>
    </div>
    <div class="AI">
      <div class="club-ai">
        <iframe
          id="club-ai"
          width="280"
          height="430"
          allow="microphone;"
          src="https://console.dialogflow.com/api-client/demo/embedded/1a9f3e5e-1a8d-4ca5-a22f-82e51e55a6f6"
        ></iframe>
      </div>
      <span id="avatar"></span>
    </div>

    <script>
      $(document).ready(function () {
        window.setTimeout(function () {
          $(".club-ai").css("display", "block");
        }, 1000);
        $("#avatar").on("click", function () {
          if ($(".club-ai").hasClass("ok") == 1) {
            $(".club-ai").slideToggle();
          }
          $(".club-ai").css("height", "auto").addClass("ok");
        });
      });
      const bot = document.querySelector("#minion-bot");
      const rect = bot.getBoundingClientRect();
      const anchorX = rect.left + rect.width/2;
      const anchorY = rect.top + rect.height/2;
      
      window.addEventListener("mousemove", (ev) => {
        const x = ev.clientX;
        const y = ev.clientY;
        const deg = angle(x, y, anchorX, anchorY);
        
        const eye = document.querySelector(".eye");
        eye.style.transform = `rotate(${150+deg}deg)`;
      })

      function angle(cx, cy, ex, ey) {
        const dy = ey - cy; 
        const dx = ex - cx;
        
        const rad = Math.atan2(dy, dx);
        const degree = rad * 180/Math.PI;
        return degree;
      }
    </script>
  </body>
</html>
